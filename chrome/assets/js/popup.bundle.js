import{u as D,r as i,j as e,I as j,c as m,a as O,b as P,E as u,i as q,m as M,d as F,e as U,g as J,f as H,R as E,h as Z,B as ee,L as se,k as oe,l as te,n as re,o as ne}from"./Loader-kohSn8j6.chunk.js";import{b as A,C as ae,S as ie,K as le}from"./background.bundle.js";import{C as W,Q as ce}from"./index-CQa3SWQ3.chunk.js";/* empty css                   */function Q(){return A.runtime.openOptionsPage()}function de(){return A.tabs.create({active:!0,url:"/History/history.html"})}function pe(){return A.tabs.query({active:!0,lastFocusedWindow:!0})}const ue="_popupBody_195f8_1",me="_icon_195f8_7",he="_qrIcon_195f8_19",_e="_copyIcon_195f8_24",fe="_link_195f8_29",we="_errorMessage_195f8_44",ge="_qrCodeContainer_195f8_51",w={popupBody:ue,icon:me,qrIcon:he,copyIcon:_e,link:fe,errorMessage:we,qrCodeContainer:ge};function ye(){const[{error:n,message:l}]=D(),[h,d]=i.useState(!1),[c,_]=i.useState(!1);return i.useEffect(()=>{let s=null;return s=setTimeout(()=>{d(!1)},1300),()=>{s&&clearTimeout(s)}},[h]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:w.popupBody,children:n?e.jsx("p",{className:w.errorMessage,children:l}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:m(w.icon,w.qrIcon),name:"qrcode",onClick:()=>_(!c)}),h?e.jsx(j,{className:m(w.icon,w.copyIcon),name:"tick"}):e.jsx(W,{text:l,onCopy:()=>d(!0),children:e.jsx(j,{className:m(w.icon,w.copyIcon),name:"copy"})}),e.jsx(W,{text:l,onCopy:()=>d(!0),children:e.jsx("h1",{className:w.link,children:O(l)})})]})}),!n&&c&&e.jsx("div",{className:w.qrCodeContainer,children:e.jsx(ce,{size:128,value:l})})]})}const xe="_header_17tfr_1",Se="_logoLink_17tfr_9",je="_logo_17tfr_9",Ne="_actions_17tfr_24",Te="_iconWrapper_17tfr_29",Ee="_tooltip_17tfr_33",be="_styledIcon_17tfr_38",p={header:xe,logoLink:Se,logo:je,actions:Ne,iconWrapper:Te,tooltip:Ee,styledIcon:be};function Ie(){const[n,l]=P(),[h,d]=i.useState(!1),[c,_]=i.useState({error:null,message:u}),s=i.useRef(null);i.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]);async function f(){d(!0);const y={apikey:n.apikey,hostUrl:n.host.hostUrl},N=await M.send(ae,y);if(d(!1),N.error)_({error:!0,message:N.message}),await F({user:null});else{_({error:!1,message:"Fetching domains successful"});const{domains:a,email:x}=N.data;await F({user:{domains:a,email:x}})}l({type:U.RELOAD_EXTENSION_SETTINGS,payload:!n.reload}),s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{_({error:null,message:u})},1e3)}const g=h?"spinner":!q(c.error)&&(c.error?"cross":"tick")||"refresh";return e.jsxs("header",{className:p.header,children:[e.jsx("a",{href:n.host.hostUrl,target:"_blank",rel:"noopener noreferrer",className:p.logoLink,children:e.jsx("img",{className:p.logo,width:"32",height:"32",src:"../assets/logo.png",alt:"logo"})}),e.jsxs("div",{className:p.actions,children:[e.jsxs("span",{className:p.iconWrapper,children:[e.jsx(j,{onClick:f,name:g,className:m("icon",p.styledIcon)}),e.jsx("span",{className:p.tooltip,children:"Sync account"})]}),n.history&&e.jsxs("span",{className:p.iconWrapper,children:[e.jsx(j,{onClick:de,name:"clock",className:m("icon",p.styledIcon)}),e.jsx("span",{className:p.tooltip,children:"History"})]}),e.jsxs("span",{className:p.iconWrapper,children:[e.jsx(j,{onClick:Q,name:"settings",className:m("icon",p.styledIcon)}),e.jsx("span",{className:p.tooltip,children:"Settings"})]})]})]})}const Ce="_formContainer_1i52w_1",ve="_formGroup_1i52w_12",ke="_formGroupRelative_1i52w_18",Re="_label_1i52w_25",Oe="_labelAbsolute_1i52w_37",Ue="_dropdown_1i52w_51",De="_dropdownTrigger_1i52w_55",Pe="_open_1i52w_77",qe="_dropdownValue_1i52w_87",Ae="_hasValue_1i52w_94",Be="_dropdownIcon_1i52w_98",Ge="_dropdownMenu_1i52w_109",Le="_dropdownItem_1i52w_133",Ve="_selected_1i52w_156",Fe="_input_1i52w_161",We="_inputError_1i52w_188",Me="_errorText_1i52w_192",He="_passwordWrapper_1i52w_203",Qe="_passwordToggle_1i52w_207",Ke="_passwordToggleIcon_1i52w_217",Ye="_submitButton_1i52w_233",Xe="_createIcon_1i52w_269",o={formContainer:Ce,formGroup:ve,formGroupRelative:ke,label:Re,labelAbsolute:Oe,dropdown:Ue,dropdownTrigger:De,open:Pe,dropdownValue:qe,hasValue:Ae,dropdownIcon:Be,dropdownMenu:Ge,dropdownItem:Le,selected:Ve,input:Fe,inputError:We,errorText:Me,passwordWrapper:He,passwordToggle:Qe,passwordToggleIcon:Ke,submitButton:Ye,createIcon:Xe};var K=(n=>(n.DefaultDomainId="default",n))(K||{});function $e(){var B,G,L;const n=P()[0],l=D()[1],[h,d]=i.useState(!1),[c,_]=i.useState(!1),[s,f]=i.useState(!1),g=i.useRef(null),{domainOptions:y,host:{hostDomain:N}}=n;i.useEffect(()=>{function t(r){g.current&&!g.current.contains(r.target)&&f(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const[a,x]=i.useState({domain:((G=(B=y.find(({id:t})=>t==="default"))==null?void 0:B.value)==null?void 0:G.trim())||u,customurl:"",password:""}),[T,S]=i.useState({}),I=!T.customurl&&!T.password&&!0;async function C(){_(!0);const t=await pe(),r=J(t,"[0].url",null);if(!(!q(r)&&H(r))){_(!1),l({type:E.SET_REQUEST_STATUS,payload:{error:!0,message:"Not a valid URL"}});return}const X={apiBody:{apikey:n.apikey,target:r,...a.customurl.trim()!==u&&{customurl:a.customurl.trim()},...!Z(a.password)&&{password:a.password},reuse:n.reuse,...a.domain.trim()!==u&&{domain:a.domain.trim()}},hostUrl:n.host.hostUrl},R=await M.send(ie,X);if(_(!1),R.error)l({type:E.SET_REQUEST_STATUS,payload:{error:!0,message:R.message}});else{const{data:{link:$}}=R;l({type:E.SET_REQUEST_STATUS,payload:{error:!1,message:$}}),x(z=>({...z,customurl:"",password:""})),S({})}}function v(t){x(r=>({...r,customurl:t})),t.length>0&&t.length<3?S(r=>({...r,customurl:"Custom URL must be at-least 3 characters"})):S(r=>({...r,customurl:void 0}))}function k(t){x(r=>({...r,password:t})),t.length>0&&t.length<3?S(r=>({...r,password:"Password must be at-least 3 characters"})):S(r=>({...r,password:void 0}))}return e.jsxs("div",{className:o.formContainer,children:[e.jsxs("div",{className:o.formGroup,children:[e.jsx("label",{className:o.label,children:"Domain"}),e.jsxs("div",{className:o.dropdown,ref:g,children:[e.jsxs("button",{type:"button",className:m(o.dropdownTrigger,s&&o.open),onClick:()=>!c&&f(!s),disabled:c,children:[e.jsx("span",{className:m(o.dropdownValue,a.domain&&o.hasValue),children:((L=y.find(({value:t})=>t===a.domain))==null?void 0:L.option)||a.domain&&O(a.domain)||"Select domain"}),e.jsx(j,{name:"chevron-down",className:m(o.dropdownIcon,s&&o.open)})]}),s&&e.jsx("div",{className:o.dropdownMenu,children:y.filter(({disabled:t})=>!t).length>0?y.filter(({disabled:t})=>!t).map(({id:t,option:r,value:b})=>e.jsx("button",{type:"button",className:m(o.dropdownItem,a.domain===b&&o.selected),onClick:()=>{x(V=>({...V,domain:b})),f(!1)},children:r||O(b)},t)):e.jsx("span",{className:o.dropdownItem,children:"No domains available"})})]})]}),e.jsxs("div",{className:o.formGroupRelative,children:[e.jsx("label",{htmlFor:"customurl",className:o.labelAbsolute,children:e.jsxs("span",{children:[N,"/"]})}),e.jsx("input",{id:"customurl",name:"customurl",type:"text",value:a.customurl,onChange:t=>{v(t.target.value.trim())},disabled:c,spellCheck:"false",className:m(o.input,T.customurl&&o.inputError)}),e.jsx("span",{className:o.errorText,children:T.customurl})]}),e.jsxs("div",{className:o.formGroupRelative,children:[e.jsx("label",{htmlFor:"password",className:o.labelAbsolute,children:e.jsx("span",{children:"Password"})}),e.jsxs("div",{className:o.passwordWrapper,children:[e.jsx("div",{className:o.passwordToggle,children:e.jsx(j,{onClick:()=>{c||d(!h)},name:h?"eye":"eye-closed",className:o.passwordToggleIcon})}),e.jsx("input",{id:"password",name:"password",type:h?"text":"password",value:a.password,spellCheck:"false",onChange:t=>{k(t.target.value)},disabled:c,className:m(o.input,T.password&&o.inputError)})]}),e.jsx("span",{className:o.errorText,children:T.password})]}),e.jsx("button",{type:"button",disabled:!I||c,onClick:C,className:o.submitButton,children:c?e.jsx(j,{className:o.createIcon,name:"spinner"}):e.jsx("span",{children:"Create"})})]})}const ze="_popup_xelqh_1",Je={popup:ze};function Ze(){const[n,l]=P(),[h,d]=D(),{reload:c}=n;return i.useEffect(()=>{async function _(){var N,a,x;const{settings:s={}}=await oe();if(!Object.prototype.hasOwnProperty.call(s,"apikey")||s.apikey===u){d({type:E.SET_REQUEST_STATUS,payload:{error:!0,message:"Extension requires an API Key to work"}}),d({type:E.SET_LOADING,payload:!1}),setTimeout(()=>Q(),1300);return}let f=le;Object.prototype.hasOwnProperty.call(s,"advanced")&&s.advanced&&Object.prototype.hasOwnProperty.call(s,"host")&&((N=s.host)==null?void 0:N.trim().length)>0&&H(s.host)&&(f={hostDomain:s.host.replace("http://",u).replace("https://",u).replace("www.",u).split(/[/?#]/)[0]||u,hostUrl:s.host.endsWith("/")?s.host.slice(0,-1):s.host});let g=!0;Object.prototype.hasOwnProperty.call(s,"history")&&(g=s.history);const y=[{id:u,option:"-- Choose Domain --",value:u,disabled:!0},{id:K.DefaultDomainId,option:f.hostDomain,value:f.hostDomain,disabled:!1}];if(Object.prototype.hasOwnProperty.call(s,"user")&&s.user){const{user:T}=s;let S=T.domains.map(({id:I,address:C,homepage:v,banned:k})=>({id:I,option:v,value:C,disabled:k}));S=y.concat(S),l({type:U.HYDRATE_EXTENSION_SETTINGS,payload:{apikey:(a=s.apikey)==null?void 0:a.trim(),domainOptions:S,host:f,history:g,reuse:s.reuse||!1}})}else l({type:U.HYDRATE_EXTENSION_SETTINGS,payload:{apikey:(x=s.apikey)==null?void 0:x.trim(),domainOptions:y,host:f,history:g,reuse:s.reuse||!1}});d({type:E.SET_LOADING,payload:!1})}_()},[c,l,d]),e.jsx(ee,{children:e.jsx("div",{id:"popup",className:Je.popup,children:h.loading?e.jsx(se,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{}),!q(h.error)&&e.jsx(ye,{}),e.jsx($e,{})]})})})}const Y=document.getElementById("popup-root");if(!Y)throw new Error("Could not find popup-root container");const es=te.createRoot(Y);es.render(e.jsx(i.StrictMode,{children:e.jsx(re,{children:e.jsx(ne,{children:e.jsx(Ze,{})})})}));
